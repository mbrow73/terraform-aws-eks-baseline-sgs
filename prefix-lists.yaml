# AWS Security Group Platform - Managed Prefix Lists
# Centralized definition of reusable CIDR blocks
# These become AWS Managed Prefix Lists for consistent referencing

prefix_lists:
  # Corporate network ranges
  corporate-networks:
    name: "corporate-networks"
    description: "Corporate office and VPN CIDR blocks"
    max_entries: 20
    address_family: "IPv4"
    entries:
      - cidr: "10.1.0.0/16"
        description: "Corporate HQ network"
      - cidr: "10.2.0.0/16"
        description: "Corporate branch offices"
      - cidr: "10.10.0.0/16"
        description: "Corporate VPN pool"
      - cidr: "192.168.1.0/24"
        description: "Corporate remote access"
    tags:
      ManagedBy: "sg-platform"
      Type: "corporate"
      
  # WAF and CDN service IPs
  waf-saas-providers:
    name: "waf-saas-providers"
    description: "WAF SaaS provider IP ranges"
    max_entries: 100
    address_family: "IPv4"
    entries:
      # Cloudflare IP ranges (commonly used WAF/CDN)
      - cidr: "10.100.1.0/24"
        description: "Cloudflare range 1"
      - cidr: "10.100.2.0/24"
        description: "Cloudflare range 2"
      - cidr: "10.100.3.0/24"
        description: "Cloudflare range 3"
      - cidr: "10.100.4.0/24"
        description: "Cloudflare range 4"
      - cidr: "10.100.5.0/24"
        description: "Cloudflare range 5"
      - cidr: "10.100.6.0/24"
        description: "Cloudflare range 6"
      - cidr: "10.100.7.0/24"
        description: "Cloudflare range 7"
      - cidr: "10.100.8.0/24"
        description: "Cloudflare range 8"
      - cidr: "10.100.9.0/24"
        description: "Cloudflare range 9"
      - cidr: "10.100.10.0/24"
        description: "Cloudflare range 10"
      # Fastly IP ranges (another common CDN/WAF)
      - cidr: "10.101.1.0/24"
        description: "Fastly range 1"
      - cidr: "10.101.2.0/24"
        description: "Fastly range 2"
      - cidr: "10.101.3.0/24"
        description: "Fastly range 3"
      - cidr: "10.101.4.0/24"
        description: "Fastly range 4"
      - cidr: "10.101.5.0/24"
        description: "Fastly range 5"
    tags:
      ManagedBy: "sg-platform"
      Type: "waf-cdn"
      
  # AWS VPC Endpoint service IPs (for S3, ECR, etc.)
  aws-vpc-endpoints:
    name: "aws-vpc-endpoints"
    description: "AWS VPC Endpoint service IP ranges"
    max_entries: 50
    address_family: "IPv4"
    entries:
      # These are region-specific and should be updated based on your regions
      # Example for us-east-1 VPC endpoint ranges
      - cidr: "10.200.1.0/24"
        description: "AWS S3 VPC endpoint range us-east-1"
      - cidr: "10.200.2.0/24"
        description: "AWS S3 service range us-east-1"
      - cidr: "10.200.3.0/24"
        description: "AWS ECR VPC endpoint range"
      - cidr: "10.200.4.0/24"
        description: "AWS EKS API endpoint range"
    tags:
      ManagedBy: "sg-platform"
      Type: "aws-services"
      
  # Application load balancer subnets
  # CI/CD and build system IPs
  ci-cd-systems:
    name: "ci-cd-systems"
    description: "CI/CD system IP ranges (GitHub Actions, Jenkins, etc.)"
    max_entries: 20
    address_family: "IPv4"
    entries:
      # GitHub Actions runner IP ranges (these change, so monitor GitHub meta API)
      - cidr: "10.150.1.0/24"
        description: "GitHub Actions hosted runners"
      - cidr: "10.150.2.0/24"
        description: "GitHub Actions hosted runners"
      - cidr: "10.150.3.0/24"
        description: "GitHub Actions hosted runners"
      - cidr: "10.150.4.0/24"
        description: "GitHub Actions hosted runners"
      # Self-hosted runners (example ranges)
      - cidr: "10.50.0.0/24"
        description: "Self-hosted GitHub Actions runners"
      - cidr: "10.51.0.0/24"
        description: "Jenkins build agents"
    tags:
      ManagedBy: "sg-platform"
      Type: "ci-cd"
      
  # Monitoring and logging services
  monitoring-services:
    name: "monitoring-services"
    description: "External monitoring service IP ranges"
    max_entries: 20
    address_family: "IPv4"
    entries:
      # DataDog agent communication
      - cidr: "10.160.1.0/24"
        description: "DataDog US1 region"
      - cidr: "10.160.2.0/24"
        description: "DataDog US1 region"
      # New Relic
      - cidr: "10.160.3.0/24"
        description: "New Relic collectors"
      - cidr: "10.160.4.0/24"
        description: "New Relic collectors"
    tags:
      ManagedBy: "sg-platform"
      Type: "monitoring"

# Regional overrides for prefix lists that vary by region
regional_overrides:
  us-west-2:
    aws-vpc-endpoints:
      entries:
        - cidr: "10.201.1.0/24"
          description: "AWS S3 VPC endpoint range us-west-2"
        - cidr: "10.201.2.0/24"
          description: "AWS S3 service range us-west-2"
          
  eu-west-1:
    aws-vpc-endpoints:
      entries:
        - cidr: "10.202.1.0/24"
          description: "AWS S3 VPC endpoint range eu-west-1"
        - cidr: "10.202.2.0/24"
          description: "AWS S3 service range eu-west-1"
